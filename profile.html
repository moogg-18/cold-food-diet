<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>個人設定</title>
  <link rel="stylesheet" href="style.css?v=120" />
</head>
<body>
  <header class="topbar">
    <h1>👤 個人設定</h1>
    <p class="sub"><a class="link" href="index.html">← 回首頁</a></p>
  </header>

  <main class="container">
    <section class="panel">
      <h2>基本資料</h2>

      <label class="small">年齡</label>
      <input id="age" class="input" type="number" placeholder="例：22" />

      <div style="height:10px"></div>

      <label class="small">性別</label>
      <select id="sex" class="input">
        <option value="female">女性</option>
        <option value="male">男性</option>
      </select>

      <div style="height:10px"></div>

      <label class="small">身高（cm）</label>
      <input id="height" class="input" type="number" placeholder="例：160" />

      <div style="height:10px"></div>

      <label class="small">體重（kg）</label>
      <input id="weight" class="input" type="number" placeholder="例：55" />

      <div style="height:10px"></div>

      <label class="small">目標</label>
      <select id="goal" class="input">
        <option value="lose">減脂</option>
        <option value="maintain">維持</option>
        <option value="gain">增肌</option>
      </select>

      <div style="height:10px"></div>

      <label class="small">運動量</label>
      <select id="activity" class="input">
        <option value="daily">每天</option>
        <option value="3-5">一週 3–5 次</option>
        <option value="0-2">一週 0–2 次</option>
      </select>

      <div style="height:14px"></div>

      <button class="btn" id="btnSave">儲存設定</button>
      <p class="note" id="msg"></p>
    </section>

    <section class="panel">
      <h2>系統說明</h2>
      <ul class="list">
        <li>本系統為一個以「飲食紀錄 × 冷性食物提醒」為核心的健康管理網站。</li>
        <li>使用者可每日記錄三餐內容，系統會自動統計熱量並辨識是否為冷性食物。</li>
        <li>系統會依據個人基本資料估算每日建議攝取熱量，並於記錄時即時提醒。</li>
        <li>即使攝取超標，系統仍允許新增紀錄，避免過度限制造成壓力。</li>
        <li>本網站為示範型 Web-based 系統，資料僅儲存在使用者裝置中，無需註冊即可使用。</li>
      </ul>
    </section>
  </main>

  <!-- 一定要先載入 app.js -->
  <script src="app.js"></script>
  <script>
    const age = document.getElementById("age");
    const sex = document.getElementById("sex");
    const height = document.getElementById("height");
    const weight = document.getElementById("weight");
    const goal = document.getElementById("goal");
    const activity = document.getElementById("activity");
    const msg = document.getElementById("msg");

    // ✅ 使用 app.js 的統一讀取方法
    const p = window.App.loadProfile();
    age.value = p.age ?? "";
    sex.value = p.sex ?? "female";
    height.value = p.height ?? "";
    weight.value = p.weight ?? "";
    goal.value = p.goal ?? "maintain";
    activity.value = p.activity ?? "3-5";

    document.getElementById("btnSave").addEventListener("click", () => {
      const profile = {
        age: Number(age.value),
        sex: sex.value,
        height: Number(height.value),
        weight: Number(weight.value),
        goal: goal.value,
        activity: activity.value
      };

      // ✅ 統一由 app.js 管理 LocalStorage
      window.App.saveProfile(profile);

      msg.textContent = "✅ 已儲存個人設定";
      msg.style.fontWeight = "700";
    });
  </script>
</body>
</html>